process {

    withName: SHOVILL {
	ext.args = "--assembler ${params.shovill_assembler} --minlen ${params.shovill_contig_minlen}"
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly/shovill" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
    withName: 'BWAMEM2_MEM_POLYPOLISH|BWAMEM2_INDEX_POLYPOLISH' {
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly/polypolish" },
            mode: params.publish_dir_mode,
            enabled: false,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
    withName: MEDAKA_CONSENSUS {
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly/medaka" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
    withName: DNAAPLER {
        ext.args = "all"
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]  
    }
    withName: RACON {
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly/racon" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
    withName: POLYPOLISH_POLISH {
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly/polypolish" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
    withName: 'RENAME_*_CTG' {
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ] 
    }

    withName: FLYE {
        ext.args = "--pacbio-hifi"
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly/flye/" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ] 
    }
    withName: FLYE_ONT {
        ext.args = [ 
            params.onthq ? "--nano-hq" : "--nano-raw"
        ].join(" ")
        publishDir = [
            path: { "${params.outdir}/samples/${meta.sample_id}/assembly/flye/" },
            mode: params.publish_dir_mode,
            enabled: true,
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ] 
    }

}